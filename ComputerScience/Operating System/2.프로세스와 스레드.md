# 프로세스(Process)와 스레드(Thread)
**프로세스(Process)** 란 **“운영체제로부터 자원을 할당받은 작업의 단위”** 라고 정의 할 수 있다.

**스레드(Thread)** 또한 **“프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위”** 로 정의 할 수 있는데,

이 정의들이 어떤 의미를 갖고 있는지 알아보자.

# 프로세스(Process)

프로세스(Process)는 **운영체제가 프로그램을 실행했을 때 생성되는 실행 단위**로, 실행 중인 프로그램을 의미한다. 즉, 컴퓨터에서 현재 동작하고 있는 프로그램을 운영체제가 관리하기 위한 형태가 프로세스이다.

### 프로그램(Program)

프로그램은 보통 정적 프로그램(Static Program)을 뜻하며, 컴퓨터에서 **실행 할 수 있는 파일**을 뜻한다.

아직 실행하지 않은 상태이므로 코드와 데이터가 포함된 즉, 쉽게 말해 그냥 코드 덩어리인 것이다.

### 프로세스(Process)

운영체제가 프로그램을 실행하면 동적인 상태인 프로세스가 생성되며, 프로세스가 실행되기 위해 운영체제는 프로세스에 필요한 자원(CPU, 메모리)을 할당한다. 이때 프로세스는 운영체제로부터 프로세스 주소 공간(가상 주소 공간)을 할당받아 메모리에 적재되고 실행된다.

> 프로세스는 자원을 소유하는 단위 → 자원을 할당받은 작업의 단위
실제 실행은 프로세스 내부의 스레드(Thread)가 담당
> 

# 스레드(Thread)

스레드는 하나의 프로세스 내에서 동시에 진행되는 작업 단위이며 하나의 프로세스에서 여러 작업들을 동시에 실행 하기 위해서 나왔다.

과거에는 프로그램을 하나의 프로세스로만 사용 했기에 하나의 프로세스 내에서 한가지 작업을 끝날 때까지 계속해서 기다려야 했다. 하지만 스레드가 등장하면서 한 프로세스 내에서 여러 작업들을 동시에 할 수 있게 된 것이다.

> 기본적으로 하나의 프로세스는 하나 이상의 스레드를 갖는다.
> 

프로세스를 생성하면 기본적으로 하나의 스레드가 생성되는데, 이것이 main 스레드인 것이다.

# 프로세스와 스레드의 메모리

## 프로세스의 메모리 구조

프로세스는 각각 별도의 주소공간을 할당 받는데, 아래와 같이 4가지 메모리 영역으로 구성된다.

<img width="236" height="347" alt="Image" src="https://github.com/user-attachments/assets/ab597403-b918-4e0c-b251-db16fed8409a" />

- **코드 영역(Code / Text)**: 실행할 명령어(기계어 형태)가 저장되는 영역으로, 프로그램의 소스코드가 컴파일 되면 만들어지는 실행 코드(Instruction)가 들어가는 영역이다. CPU는 이 영역의 명령어를 읽어서 실행한다.
- **데이터 영역(Data)**: 프로그램이 실행 되는 동안 유지되는 전역 변수나 각종 데이터(정적 데이터)들이 모여있다. 데이터 영역은 .data, .rodata, .bss 영역으로 세분화 된다.
    - .data : **전역 변수 또는 static 변수 등 초기 값이 있는 데이터**를 저장
    - .bss : **초기값 없는** 전역 변수, static 변수가 저장
    - .rodata : **읽기 전용 데이터**들인 const같은 상수 키워드, 문자열 리터럴 저장
- **스택 영역(Stack)**: 함수 호출 과정에서 필요한 **지역 변수, 매개변수, 반환 주소** 등의 임시 데이터가 저장되는 영역이다. 함수가 호출되면 스택에 **스택 프레임(Stack Frame)** 이 쌓이고, 호출이 종료되면 해당 프레임이 제거된다. 스택은 **스레드마다 독립적으로 존재**하며, 만약 영역을 초과하면 **Stack Overflow** 가 발생할 수 있다.
- **힙 영역(Heap)** : 프로그램 실행 중 사용자(프로그램)에 의해 **동적으로 할당/해제되는 데이터**를 저장하는 영역이다. 힙은 프로세스 단위로 관리되며, 같은 프로세스 내 여러 스레드가 **공유**할 수 있다.

위 그림에서 Stack과 Heap 사이에 위아래로 화살표가 그려진 것은, 스**택 영역과 힙 영역이 프로세스가 실행되는 동안 크기가 늘어났다 줄어드는 동적인 영역이기 때문이다.** 위에서 잠깐 설명했듯이 힙과 스택이 서로 자라면서 충돌하면 메모리 부족 문제가 발생할 수도 있다.

> **힙은 아래에서 위로, 스택은 위에서 아래로 증가하는 것을 확인 할 수 있다.**
> 

반면 **코드 영역과 데이터 영역은 선언할 때 크기가 결정되는 정적 영역**이다.

## 스레드의 자원 공유

스레드는 프로세스 내에서 동시에 진행되는 실행 단위이다. 스레드들은 같은 프로세스의 자원을 공유할 수 있기 때문에 하나의 프로세스 내에서 동시 작업이 가능하다.

위에서 얘기했듯이 스레드는 각각의 스택 영역을 갖고 있으며 이를 통해 독립적으로 함수 호출이 가능하다. 즉, 스택 영역을 가짐으로써 스레드는 독립적인 실행 흐름을 가질 수 있게 되는 것이다.

이에 더해 **코드(Code), 데이터(Data), 힙(Heap) 영역은 프로세스에 속하는 자원**이므로, 같은 프로세스 내 여러 스레드가 이를 공유할 수 있다. (코드 영역은 보통 읽기 전용으로 공유되며, 데이터/힙 영역은 공유하여 읽고 쓸 수 있다.)

이를 통해 하나의 프로세스를 다수의 실행 단위인 스레드가 자원을 공유하고, 자원의 생성과 관리의 중복성을 최소화하여 **오버헤드를 줄이고 성능을 높일 수 있다.**

> 반면 프로세스는 서로 독립적인 주소 공간을 할당받기 때문에 다른 프로세스의 메모리에 직접 접근할 수 없다.
> 

## 프로세스의 자원 공유

앞에서도 얘기했듯 각 프로세스는 다른 프로세스의 메모리에 직접 접근할 수 없지만, 특별한 방법을 통해 접근하는 것이 가능하다.

1. IPC(Inter-Process Communication)
2. LPC(Local Inter-Process Communication)
3. 별도로 공유 메모리를 만들어 정보를 주고받도록 설정

IPC의 관해서는 이 후에 더 자세히 다루겠다.

# 프로세스와 스레드의 동시 실행

우리는 컴퓨터나 모바일을 사용하면서 여러 프로그램을 동시에 사용할 수 있다. 이는 운영체제가 여러 프로세스/스레드를 번갈아 실행시키거나(동시성), 여러 코어에서 병렬로 실행시키는 방식(병렬성)을 통해 가능한 것이다. 이러한 기술을 **멀티태스킹(Multi-tasking)** 이라고 한다.

## 멀티 코어와 스레드

CPU 한 개는 여러 개의 코어(Core)를 가질 수 있다. 코어는 명령어를 메모리에서 가져와 해석하고 실행하는 물리적인 처리 유닛이며, 예를 들어 4코어 CPU는 4개의 물리 코어를 가진다.

그렇다면 흔히 말하는 “4코어 8쓰레드”에서 8쓰레드는 무엇을 의미할까?

여기서의 쓰레드는 운영체제의 스레드(Thread) 개념이 아니라, CPU가 제공하는 **논리 코어(Logical CPU, Hardware Thread)** 를 의미한다.

즉, “4코어 8쓰레드”는 물리 코어 4개가 **하드웨어 스레드 8개(논리 코어 8개)** 를 제공하여, 동시에 실행할 수 있는 실행 흐름이 8개라는 뜻이다. 이러한 기술은 대표적으로 **하이퍼스레딩(Hyper-Threading)** 으로 알려져 있다.

다만 논리 코어는 물리 코어의 실행 자원을 공유하므로, 성능이 항상 2배가 되는 것은 아니다.

## 병렬성(Parallelism)

병렬성은 **여러 개의 코어(또는 논리 코어)** 에서 여러 작업(프로세스/스레드)이 **물리적으로 동시에 실행되는 것**을 의미한다. 즉, 멀티코어 환경에서는 여러 작업이 서로 다른 코어에서 같은 시간에 실행될 수 있다.

## 동시성(Concurrency)

동시성은 둘 이상의 작업이 **동시에 실행되는 것처럼 보이도록** 처리되는 것을 의미한다. 병렬성이 실제로 물리적인 동시 실행이라면, 동시성은 하나의 코어에서도 여러 작업을 번갈아 실행하여 사용자에게 동시에 수행되는 것처럼 보이게 한다.

정확히는 운영체제가 여러 프로세스/스레드를 아주 빠르게 번갈아 처리하기 때문에 사람이 보기에는 마치 동시에 프로그램이 실행되는 것처럼 보이게 된다. 이러한 방식은 사용자에게 더 빠른 반응성을 제공할 수 있다.

이때 실행 중인 작업을 전환하는 핵심 메커니즘 중 하나가 **컨텍스트 스위칭(Context Switching)** 이다.

컨텍스트 스위칭에 관해서는 이 후에 더 자세하게 다루겠다.

### 동시성이 필요한 이유

정말 동시에 실행되는 병렬성만 있으면 되지 않을까? ‘동시에 실행되는 것처럼’ 보이는 동시성이 왜 필요할까?

첫 번째 이유는 **반응성(Responsiveness)** 때문이다. 작업들 중에는 짧은 시간을 필요로 하는 작업과 오래 걸리는 작업이 존재한다. 만약 오래 걸리는 작업이 CPU를 계속 점유한다면, 짧은 작업은 처리 시간이 짧더라도 오래 기다려야 한다. 따라서 운영체제는 작업을 작은 단위로 나누어 번갈아 실행함으로써 사용자에게 빠른 반응을 제공한다.

두 번째 이유는 **하드웨어 자원의 한계** 때문이다. CPU 코어 수는 제한되어 있는데, 실제로 동시에 실행 가능한 프로세스/스레드는 수백~수천 개가 될 수 있다. 즉, 코어 개수만큼만 병렬 실행이 가능하므로 운영체제는 하나의 코어에서도 여러 작업이 동시에 진행되는 것처럼 보이도록 스케줄링(동시성)을 제공해야 한다.

> 결과적으로 운영체제는 제한된 코어에서 여러 작업을 스케줄링하며 동시성을 제공하고, 멀티코어 환경에서는 병렬성까지 함께 활용하여 전체 성능과 반응성을 높인다.
> 

📌 특히 I/O 작업(디스크, 네트워크 등)은 CPU에 비해 매우 느리기 때문에, 운영체제는 한 작업이 I/O를 기다리는 동안 다른 작업을 실행하여 CPU 유휴 시간을 줄인다.

---

### iOS의 프로세스와 스레드 관리

- 멀티 태스킹
    - iOS는 멀티 태스킹 환경을 지원해 여러 앱이 동시에 실행 될 수 있다.
- 스레드 관리
    - iOS에서는 스레드 생성 및 관리를 위한 API를 제공한다.
        - GCD
        - Operation Queue
        - Swift Concurrency
- 메인 스레드
    - iOS 앱은 메인 스레드에서 실행된다. 메인 스레드는 UI이벤트 처리와 화면 업데이트 등 사용자 인터페이스 작업을 담당한다. 따라서 메인 스레드의 작업은 빠르게 처리 되어야 하며, 오래 걸리는 작업은 백그라운드 스레드에서 처리하는 것이 좋다.

---
